#!/bin/bash
echo "Que voulez faire?"
echo "Supprimer un utilisateur du système -- sup "
echo "Afficher les ouvertures de sessions depuis une date donnée -- log "
echo "Afficher les plus gros fichier du système -- load"
read answer

if [[ $answer = "sup" ]]; then
    echo "Quel utilisateur voulez-vous supprimer?"
    read user
    a=$(sudo find -user $user)
    sudo chown -R root $a
    sudo userdel $user
    sudo rm -r /home/$user
fi

if [[ $answer = "log" ]]; then
    echo "Quel est la date (mmm jj)?"
    read date
    cutresult=$(echo $date |cut -d' ' -f1)
    if [[ "${cutresult,,}"  = "sep" ]] || [[ "${cutresult,,}" = "oct" ]] || [[ "${cutresult,,}" = "nov" ]] || [[ "${cutresult,,}" = "déc" ]] || [[ "${cutresult,,}" = "jan" ]] || [[ "${cutresult,,}" = "fév" ]] || [[ "${cutresult,,}" = "mar" ]] || [[ "${cutresult,,}" = "avr" ]] || [[ "${cutresult,,}" = "mai" ]] || [[ "${cutresult,,}" = "jun" ]] || [[ "${cutresult,,}" = "jul" ]] || [[ "${cutresult,,}" = "aoû" ]]; then
        sudo journalctl -u systemd-logind |grep -i "$date" |grep -i "systemd-logind" |grep -i "user"|cut -d' ' -f11
    fi
fi

if [[ $answer = "load" ]]; then
    echo "Combien de fichier: "
    read number
    cd /
    sudo find -type f 2< /dev/null -exec du -Sh {} + | sort -rh |  head -$number
fi

#Consultation utile:
	#https://www.malekal.com/comment-utiliser-la-commande-chown/#Comment_changer_recursivement_le_propriete_d8217un_repertoire
	#https://www.malekal.com/commande-mv-deplacer-des-fichiers-ou-repertoires/#Deplacer_plusieurs_fichier_vers_un_repertoire_specifique
	#https://docs.oracle.com/cd/E26919_01/html/E25808/sysresdiskuse-3.html
	#Le github du cours
	#https://forum.cabane-libre.org/topic/50/bash-convertir-une-chaîne-de-caractères-en-majuscule-minuscule
	#https://bdl.oqlf.gouv.qc.ca/bdl/gabarit_bdl.asp?id=3619
	#https://www.ionos.fr/digitalguide/serveur/configuration/commande-find-sous-linux/
	#https://www.redhat.com/sysadmin/linux-find-command
	#https://www.developpez.net/forums/d28384/systemes/linux/shell-commandes-gnu/bash-decouper-chaine-caracteres/
	#https://fr.m.wikibooks.org/wiki/Programmation_Bash/Boucles
	#https://unix.stackexchange.com/questions/47584/in-a-bash-script-using-the-conditional-or-in-an-if-statement
	#https://pieces-of-code.com/guide/howto/linux-ls-sort.html#tri-alphanumerique-defaut
	#https://www.malekal.com/comment-trouver-fichiers-volumineux-linux/
	#https://www.delftstack.com/fr/howto/linux/sorting-files-by-size-in-linux/
